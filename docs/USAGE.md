# Overview

Avocado is a mixture of Ruby modules that you include into your own application
classes and Ruby classes which will run directly from the gem. The classes are
intended to provide good defaults for basic scenarios, and can be subclassed and
overridden for special cases beyond the basics.

## Requirements

You must be running Rails 7.1 or newer within your application. The gem uses
some Rails features (`authenticate_by`, `has_secure_password`, `normalizes`,
etc) which don't exist in earlier versions.

You should have a database schema with columns that match the `users`,
`sessions`, and `events` tables from the [demo app schema]. It's ok to have more
columns in each table, but you need at least what is shown there. Slight
variations (using `uuid` instead of `bigint` for example) are harmless, but
large departures will break the integration.

Your application must also have:

- An `ApplicationController` base controller class
- An `ApplicationMailer` base mailer class
- A `root_path` method (usually generated by routes)

## Usage

Once those requirements are met, include the modules into your models:

```ruby
class User < ApplicationRecord
  include Avocado::User
end

class Session < ApplicationRecord
  include Avocado::Session
end

class Event < ApplicationRecord
  include Avocado::Event
end
```

This will set up some basic validations, association, normalizations, and
callbacks for those models.

You also need to add a module to your top level controller:

```ruby
class ApplicationController < ActionController::Base
  include Avocado::Authentication
end
```

## Summary

The gem will create routes that go to the controllers during app initialization.

With the routes created and all code loaded, these controller/route features
exist:

- `Registrations` -- Create new user records
- `Sessions` -- Sign in & out, list & destroy active sessions
- `Passwords` and `Emails` -- Account edit pages
- `Recoveries` -- Enable password reset process
- `Verifications` -- Enable email address verification process
- `Affirmations` -- Enable "passwordless" auth via secure link
- `Events` -- List view of user activity history

There is an `Avocado::Mailer` which gets called to send emails.

## Customization

There is currently not any explicit configuration ability. To override
functionality, you can:

- Redefine a method created in one of the models by the included module
- Subclass a controller and update the routing to go to your subclass
- Place views in your app where avocado expects them to override the defaults

## Examples

There is a [demo app] used by the specs which has some example usage.

[demo app schema]: https://github.com/tcuwp/avocado/blob/main/spec/internal/db/schema.rb
[demo app]: https://github.com/tcuwp/avocado/blob/main/spec/internal
